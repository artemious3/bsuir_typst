# Линтер для Typst

**ВНИМАНИЕ** : реализован с помощью высших сил (Gemini 3), правильность не гарантируется.

Расширяемый анализатор файлов на языке Typst, основанный на команде `typst query`.

## Возможности

На данный момент линтер проверяет следующие правила:
- **ОтсутствиеМетки**: У каждой фигуры (`figure`) должна быть метка (`@label`).
- **НеиспользуемаяМетка**: Каждая метка фигуры должна хотя бы один раз упоминаться в тексте через ссылку (`@ref`).
- **ЗнакПрепинанияВКонцеПодписи**: Подписи к фигурам (`caption`) не должны заканчиваться знаками препинания (например, точкой).
- **ПунктуацияЗаголовков**: Заголовки 1 и 2 уровня не должны заканчиваться точкой; заголовки 3 уровня обязаны заканчиваться точкой.
- **ПунктуацияСписков**: Элементы списка должны начинаться со строчной буквы. Все элементы, кроме последнего, должны заканчиваться точкой с запятой (`;`), а последний элемент — точкой (`.`).

**Важно:** Фигуры с типом `kind: "hidden_appendix"` игнорируются всеми правилами анализа фигур.

## Использование

Для запуска линтера выполните команду:

```bash
python linter/linter.py <путь_к_файлу_typst>
```

Линтер поддерживает передачу нескольких файлов одновременно. В процессе работы он выводит информацию о текущем этапе (сбор данных, проверка правил).

## Как расширить

Архитектура линтера позволяет легко добавлять новые правила:

1. Создайте новый класс, унаследовав его от `Rule` в файле `linter/linter.py`.
2. Реализуйте свойство `name` (название правила для вывода) и метод `check(**kwargs)`. Данные из `typst query` (figures, refs, headings, lists) доступны через `kwargs.get()`.
3. Для анализа текстового содержимого используйте глобальную функцию `extract_text(node)`.
4. Зарегистрируйте новое правило в функции `main()`, добавив строку `linter.add_rule(ВашеНовоеПравило())`.

## Требования

- Python 3.x
- Установленный компилятор `typst` в PATH (необходим для работы `typst query`).
